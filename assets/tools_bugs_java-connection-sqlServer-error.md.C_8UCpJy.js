import{_ as e,B as n,o as t,c as r,j as a,a as l,G as p,a8 as h}from"./chunks/framework.D0fTRY1a.js";const v=JSON.parse('{"title":"Java连接SqlServer错误","description":"","frontmatter":{"title":"Java连接SqlServer错误","order":1,"category":["报错及Bug"],"tag":["报错及Bug"],"pageview":false,"date":"2023-09-06T00:00:00.000Z","comment":false,"breadcrumb":false,"copyright":"版权所有 © 2024-present 程序员Leo"},"headers":[],"relativePath":"tools/bugs/java-connection-sqlServer-error.md","filePath":"tools/bugs/java-connection-sqlServer-error.md","lastUpdated":null}'),o={name:"tools/bugs/java-connection-sqlServer-error.md"};function d(k,s,c,g,E,u){const i=n("ArticleMetadata");return t(),r("div",null,[s[0]||(s[0]=a("h1",{id:"java连接sqlserver错误",tabindex:"-1"},[l("Java连接SqlServer错误 "),a("a",{class:"header-anchor",href:"#java连接sqlserver错误","aria-label":'Permalink to "Java连接SqlServer错误"'},"​")],-1)),p(i),s[1]||(s[1]=h(`<blockquote><p>最近公司换了新项目，这边也是进入了新一轮的开发，当项目经理把需求发给我之后我开始了需求的分析和coding。不一会我便开始拉去代码在本地开始跑程序。</p></blockquote><h2 id="问题发现" tabindex="-1">问题发现 <a class="header-anchor" href="#问题发现" aria-label="Permalink to &quot;问题发现&quot;">​</a></h2><p><strong>这次使用的是SqlServer数据库，之前并没有使用过，但是问题不大，我按照需求文档的步骤连接好SqlServer之后，启动SpringBoot项目，发现了一个报错，如下：</strong></p><p><img src="https://gaoziman.oss-cn-hangzhou.aliyuncs.com/img/default.jpg" alt="" loading="lazy"></p><p>刚开始我以为是SqlServer连接问题呢，于是便去查看数据库，发现数据库一切正常，我首先第一时间问了我的同事，他们是否有这样的问题，发现他们并没有，于是我便开始了我最拿手的环节，面向百度编程。</p><h2 id="开始解决" tabindex="-1">开始解决 <a class="header-anchor" href="#开始解决" aria-label="Permalink to &quot;开始解决&quot;">​</a></h2><p>具体报错信息是这样，于是我便开始了百度</p><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">报错：ERROR c.a.d.p.DruidDataSource$CreateConnectionThread [Druid</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ConnectionPool</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Create</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1218864105</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] create connection SQLException, url</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">jdbc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sqlserver</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//47.114.91.217:1433;DatabaseName=PileTestingSystem, errorCode 0, state 08S01</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><code>首先我进行了中文翻译</code></p><blockquote><p>中文翻译错误：c.a.d.p.DruidDataSource$CreateConnectionThread[Druid-ConnectionPool-Create-1218864105]创建连接SQLException，url:jdbc:sqlserver://47.114.91.217:1433;DatabaseName=PileTestingSystem，错误代码0，状态08S01 com.microsoft.sqlserver.jdbc.SQLServerException:驱动程序无法使用安全套接字层（SSL）加密建立到SQL Server的安全连接。错误：“客户端首选项[TLS12]不接受服务器选择的协议版本TLS10”。客户连接ID:c8434f3c-5f82-4cf2-b111-099e140f33d0 在com.microsoft.sqlserver.jdbc.SQLServerConnection.terminate（SQLServerConnection.java:2670）~[mssql-jdbc-6.4.0.jre8.jar:？]</p></blockquote><p><strong>这个错误主要就是驱动程序无法使用安全套（SSL）加密建立到SQL Server的安全连接</strong></p><h2 id="解决方法" tabindex="-1">解决方法 <a class="header-anchor" href="#解决方法" aria-label="Permalink to &quot;解决方法&quot;">​</a></h2><p><strong>最终在我的查询下，找到了两种解决方法，现在提供给大家</strong></p><h3 id="方法一" tabindex="-1">方法一 <a class="header-anchor" href="#方法一" aria-label="Permalink to &quot;方法一&quot;">​</a></h3><p>如果使用的是jdk1.8的话，先要找到自己安装JDK目录下的<strong>java.security</strong>文件并进行修改， 本人目录如下：<strong>D:\\jdk\\jre\\lib\\security</strong>下就会有这个<strong>java.security</strong>文件 具体的修改情况如下 ：</p><p>打开文件后，注释掉这三行代码（也就是在这三行代码之前加 # ）：</p><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">jdk.tls.disabledAlgorithms</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SSLv3, TLSv1, TLSv1.</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, RC4, DES, MD5withRSA,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DH keySize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1024</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, EC keySize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 224</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, 3DES_EDE_CBC，anon, NULL,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">include jdk.disabled.namedCurves</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>然后重新启动项目，建立SQL Server的安全套连接就没有问题了。 <strong>图片如下：</strong><strong>没修改之前的java.security文件：</strong></p><p><img src="https://gaoziman.oss-cn-hangzhou.aliyuncs.com/img/image-20230330104645835.png" alt="image-20230330104645835" loading="lazy"></p><p><strong>修改之后的java.security文件：</strong></p><p><img src="https://gaoziman.oss-cn-hangzhou.aliyuncs.com/img/image-20230330104728125.png" alt="image-20230330104728125" loading="lazy"></p><h3 id="方法二" tabindex="-1">方法二 <a class="header-anchor" href="#方法二" aria-label="Permalink to &quot;方法二&quot;">​</a></h3><p>打开文件后，找到这三行代码：</p><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">jdk.tls.disabledAlgorithms</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SSLv3, TLSv1, TLSv1.</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, RC4, DES, MD5withRSA,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DH keySize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1024</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, EC keySize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 224</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, 3DES_EDE_CBC，anon, NULL,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">include jdk.disabled.namedCurves</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>然后去掉：其中的3DES_EDE_CBC,字符。（图片如下） 然后重新启动项目，建立SQL Server的安全套连接就没有问题了。 <strong>没修改之前的java.security文件：</strong></p><p><img src="https://gaoziman.oss-cn-hangzhou.aliyuncs.com/img/image-20230330104807347.png" alt="image-20230330104807347" loading="lazy"></p><p><strong>修改之后的java.security文件：</strong></p><p><img src="https://gaoziman.oss-cn-hangzhou.aliyuncs.com/img/image-20230330104824800.png" alt="image-20230330104824800" loading="lazy"></p><p><strong>到这里问题就解决了，这里想告诉大家，遇到之前没有碰到过的新问题，不要慌，先追溯本源，看看到底是哪里出错了，思路一定要清晰，实在没有头绪的话可以百度，利用好搜索引擎，你一定可以的!!!</strong></p>`,29))])}const y=e(o,[["render",d]]);export{v as __pageData,y as default};
